(function(e){function t(t){for(var r,c,i=t[0],l=t[1],u=t[2],d=0,v=[];d<i.length;d++)c=i[d],Object.prototype.hasOwnProperty.call(a,c)&&a[c]&&v.push(a[c][0]),a[c]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(e[r]=l[r]);s&&s(t);while(v.length)v.shift()();return o.push.apply(o,u||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],r=!0,i=1;i<n.length;i++){var l=n[i];0!==a[l]&&(r=!1)}r&&(o.splice(t--,1),e=c(c.s=n[0]))}return e}var r={},a={app:0},o=[];function c(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.m=e,c.c=r,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)c.d(n,r,function(t){return e[t]}.bind(null,r));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/HyperDiveLevelCreator/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],l=i.push.bind(i);i.push=t,i=i.slice();for(var u=0;u<i.length;u++)t(i[u]);var s=l;o.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("cd49")},"0b04":function(e,t,n){},"64be":function(e,t,n){"use strict";n("c894")},"717a":function(e,t,n){"use strict";n("0b04")},"761c":function(e,t,n){"use strict";n("a880")},"7d05":function(e,t,n){},a880:function(e,t,n){},c894:function(e,t,n){},cd49:function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("7a23"),a={class:"content"},o={class:"content-section"},c={class:"content-section"};function i(e,t,n,i,l,u){var s=Object(r["l"])("JsonEditor"),d=Object(r["l"])("LevelCreator");return Object(r["h"])(),Object(r["c"])("div",a,[Object(r["d"])("div",o,[Object(r["d"])(s)]),Object(r["d"])("div",c,[Object(r["d"])(d)])])}var l={class:"level-creator"},u={class:"level-creator-header"},s={class:"level-creator-footer"},d=Object(r["d"])("label",null,"Block Type: ",-1),v=Object(r["d"])("option",{value:"breakable"},"Breakable",-1),b=Object(r["d"])("option",{value:"unbreakable"},"Unbreakable",-1),f={ref:"canvas"};function p(e,t,n,a,o,c){return Object(r["h"])(),Object(r["c"])("div",l,[Object(r["d"])("div",u,[Object(r["d"])("button",{onClick:t[1]||(t[1]=function(){return a.newWave.apply(a,arguments)})},"+ Wave")]),Object(r["d"])("div",s,[d,Object(r["p"])(Object(r["d"])("select",{"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.blockType=t})},[v,b],512),[[r["n"],e.blockType]])]),Object(r["d"])("canvas",f,null,512)])}var O=n("5530"),j=(n("a4d3"),n("e01a"),n("99af"),n("4160"),n("13d5"),n("a434"),n("4fad"),n("d3b7"),n("159b"),n("3835")),h=Symbol();function w(e){var t=Object(r["j"])(e),n=Object(r["k"])("unbreakable"),a=function(e){Object.entries(e).forEach((function(e){var n=Object(j["a"])(e,2),r=n[0],a=n[1];t[r]=a}))};function o(e){e||(e=20),t["waves"].push({nextSpawnHeight:e,obstacles:[]})}var c=Object(r["a"])((function(){var e=t.waves.reduce((function(e,t){return e+=t.nextSpawnHeight,e}),0);return"".concat(e,"/").concat(t.height)})),i=function(e,n){t.waves[e].obstacles=n},l=function(e){t.waves.splice(e,1)},u=function(e){n.value=e};Object(r["i"])(h,{blockType:n,changeBlockType:u,levelJson:t,setJSON:a,addNewWave:o,setObstacles:i,deleteWave:l,remainingHeight:c})}function g(){var e=Object(r["f"])(h);if(!e)throw new Error("Provider need context");return e}n("b0c0"),n("ac1f"),n("1276");var y=n("633b"),m=n("6fcd"),k=5,C=function(e,t){var n=new y["Engine"](e,!0,{preserveDrawingBuffer:!0,stencil:!0}),r=function(){var r=new y["Scene"](n),a=new y["FreeCamera"]("camera1",new y["Vector3"](0,5,-10),r);a.position=new y["Vector3"](.5,9,-17.8),a.rotation=new y["Vector3"](.4653956558758062,-.07168276100777128,0),a.attachControl(e,!1);new y["HemisphericLight"]("light1",new y["Vector3"](0,1,0),r);var o=new y["StandardMaterial"]("no-selected",r);o.diffuseColor=new y["Color3"](255,255,255),o.alpha=.5;var c=new y["StandardMaterial"]("breakable",r);c.diffuseColor=new y["Color3"](255,1,1);t.setObstacles;var i=t.levelJson,l=0,u=[],s=0,d=[];i.waves.forEach((function(e,n){console.log("i was called"),u.push(l);var a=Object.entries(e.obstacles).reduce((function(e,t){var n=Object(j["a"])(t,2),r=n[0],a=n[1],o=a.reduce((function(e,t){var n=t.x,a=t.y,o=E(n,a);return e[o]=r,e}),{});return Object(O["a"])(Object(O["a"])({},e),o)}),{});console.log(a),S(r,l,a,n,d,t),l+=e.nextSpawnHeight}));var v=m["AdvancedDynamicTexture"].CreateFullscreenUI("UI"),b=x(!0),f=x(!1);b.onPointerClickObservable.add((function(){var e=u[s-1];void 0===e||e<0||(s-=1,T(a,e))})),f.onPointerClickObservable.add((function(){var e=u[s+1];void 0===e||e<0?console.warn("ops...",e):(s+=1,T(a,e))})),v.addControl(b),v.addControl(f);var p=m["Button"].CreateSimpleButton("Save","Save");return p.width=.2,p.height="40px",p.color="white",p.background="green",p.thickness=0,p.top=-50,p.horizontalAlignment=m["Container"].HORIZONTAL_ALIGNMENT_CENTER,p.verticalAlignment=m["Container"].VERTICAL_ALIGNMENT_BOTTOM,p.onPointerClickObservable.add((function(){d.forEach((function(e,n){var r=Object.entries(e).reduce((function(e,t){var n=Object(j["a"])(t,2),r=n[0],a=n[1],o=r.split(","),c=Object(j["a"])(o,2),i=c[0],l=c[1];return void 0===e[a]&&(e[a]=[]),e[a].push({x:i,y:l}),e}),{});t.setObstacles(n,r)}))})),v.addControl(p),r},a=r();n.runRenderLoop((function(){a.render()})),window.addEventListener("resize",(function(){n.resize()}))};function x(e){var t=e?"Up":"Down",n=m["Button"].CreateSimpleButton(t,t);return n.width=.2,n.height="40px",n.color="white",n.background="black",n.thickness=0,n.horizontalAlignment=e?m["Container"].HORIZONTAL_ALIGNMENT_RIGHT:m["Container"].HORIZONTAL_ALIGNMENT_LEFT,n}function S(e,t,n,r,a,o){var c=[];a[r]=n;for(var i=0;i<k;++i){c[i]=c[i]||[];for(var l=function(l){var u=y["Mesh"].CreateBox("box",.5,e);u.position.copyFromFloats(i-k/2,-t,l-k/2);var s=E(i,l),d=n[s];u.material=d?e.getMaterialByName("breakable"):e.getMaterialByName("no-selected"),u.actionManager=new y["ActionManager"](e),u.actionManager.registerAction(new y["ExecuteCodeAction"](y["ActionManager"].OnPickTrigger,(function(){var t,n="no-selected"===(null===(t=u.material)||void 0===t?void 0:t.name);if(n){var c=o.blockType.value;u.material=e.getMaterialByName("breakable"),a[r][s]=c}else u.material=e.getMaterialByName("no-selected"),delete a[r][s]}))),c[i][l]=u},u=0;u<k;++u)l(u)}}function T(e,t){e.position=new y["Vector3"](.5,9-t,-17.8),e.rotation=new y["Vector3"](.4653956558758062,-.07168276100777128,0)}function E(e,t){var n="".concat(e,",").concat(t);return n}var N={setup:function(){var e=Object(r["k"])(null),t=Object(r["k"])(!1),n=g();Object(r["g"])((function(){t.value=!0,C(e.value,n)}));var a=function(){n.addNewWave()},o=n["levelJson"];return Object(r["o"])(o,(function(){t.value&&(console.log("re rendering"),C(e.value,n))})),Object(O["a"])({canvas:e,newWave:a},n)}};n("717a");N.render=p;var M=N,A={class:"editor"},L={class:"actions"};function B(e,t,n,a,o,c){return Object(r["h"])(),Object(r["c"])("div",A,[Object(r["d"])("div",L,[Object(r["d"])("div",null,Object(r["m"])(e.remainingHeight),1),Object(r["d"])("div",null,[Object(r["d"])("button",{onClick:t[1]||(t[1]=function(){return e.save.apply(e,arguments)})},"Update"),Object(r["d"])("button",{onClick:t[2]||(t[2]=function(){return e.exportFile.apply(e,arguments)})},"Export")])]),Object(r["d"])("textarea",{class:"editor-area",value:e.jsonString,onInput:t[3]||(t[3]=function(){return e.change.apply(e,arguments)})},null,40,["value"])])}n("a15b"),n("3ca3"),n("ddb0"),n("2b3d");var J=Object(r["e"])({setup:function(){var e=g(),t=Object(r["k"])(JSON.stringify(e["levelJson"],null,4));Object(r["o"])(e["levelJson"],(function(){t.value=JSON.stringify(e["levelJson"],null,4)}));var n=function(e){t.value=e.target.value},a=function(){try{var n=JSON.parse(t.value);e.setJSON(n)}catch(r){window.alert("invalid json"),console.error(r)}},o=function(){var e=t.value,n=new Blob([e],{type:"text/plain"}),r=document.createEvent("MouseEvents"),a=document.createElement("a");a.download="test.json",a.href=window.URL.createObjectURL(n),a.dataset.downloadurl=["text/json",a.download,a.href].join(":"),r.initEvent("click",!0,!1),a.dispatchEvent(r)};return Object(O["a"])(Object(O["a"])({},e),{},{jsonString:t,change:n,save:a,exportFile:o})}});n("761c");J.render=B;var _=J,H={env:"Wall",height:250,offsetTop:50,offsetBottom:50,waves:[{nextSpawnHeight:20,obstacles:{unbreakable:[{x:0,y:0}]}}]},I=H,P=Object(r["e"])({name:"App",components:{LevelCreator:M,JsonEditor:_},setup:function(){w(I)}});n("64be");P.render=i;var R=P;n("7d05");Object(r["b"])(R).mount("#app")}});
//# sourceMappingURL=app.c229580d.js.map